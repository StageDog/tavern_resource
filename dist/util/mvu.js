import{defineStore as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';const t=Vue;function a(e){return!!(0,t.getCurrentScope)()&&((0,t.onScopeDispose)(e),!0)}const s='undefined'!=typeof window&&'undefined'!=typeof document;'undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString;function n(e,t){return function(...a){return new Promise((s,n)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(s).catch(n)})}}const o=e=>e();function r(e){const t=Object.create(null);return a=>t[a]||(t[a]=e(a))}const i=/\B([A-Z])/g,c=(r(e=>e.replace(i,'-$1').toLowerCase()),/-(\w)/g);r(e=>e.replace(c,(_,e)=>e?e.toUpperCase():''));function l(e,n=1e3,o={}){const{immediate:r=!0,immediateCallback:i=!1}=o;let c=null;const l=(0,t.shallowRef)(!1);function u(){c&&(clearInterval(c),c=null)}function d(){l.value=!1,u()}function p(){const a=(0,t.toValue)(n);a<=0||(l.value=!0,i&&e(),u(),l.value&&(c=setInterval(e,a)))}if(r&&s&&p(),(0,t.isRef)(n)||'function'==typeof n){a((0,t.watch)(n,()=>{l.value&&s&&p()}))}return a(d),{isActive:(0,t.shallowReadonly)(l),pause:d,resume:p}}function u(e,a,s={}){const{eventFilter:r=o,...i}=s,c=n(r,a);let l,u,d;if('sync'===i.flush){let a=!1;u=()=>{},l=e=>{a=!0,e(),a=!1},d=(0,t.watch)(e,(...e)=>{a||c(...e)},i)}else{const a=[];let s=0,n=0;u=()=>{s=n},a.push((0,t.watch)(e,()=>{n++},{...i,flush:'sync'})),l=e=>{const t=n;e(),s+=n-t},a.push((0,t.watch)(e,(...e)=>{const t=s>0&&s===n;s=0,n=0,t||c(...e)},i)),d=()=>{a.forEach(e=>e())}}return{stop:d,ignoreUpdates:l,ignorePrevAsyncUpdates:u}}function d(a,s){return'message'!==s.type||void 0!==s.message_id&&'latest'!==s.message_id||(s.message_id=-1),e(`mvu_data.${_(s).entries().sortBy(e=>e[0]).map(e=>e[1]).join('.')}`,errorCatched(()=>{const e=(0,t.ref)(a.parse(_.get(getVariables(s),'stat_data',{})));l(()=>{const t=_.get(getVariables(s),'stat_data',{}),o=a.safeParse(t);o.error||(_.isEqual(e.value,o.data)||n(()=>{e.value=o.data}),_.isEqual(t,o.data)||updateVariablesWith(e=>_.set(e,'stat_data',o.data),s))},2e3);const{ignoreUpdates:n}=u(e,t=>{const o=a.safeParse(t);o.error||(_.isEqual(t,o.data)||n(()=>{e.value=o.data}),updateVariablesWith(e=>_.set(e,'stat_data',o.data),s))},{deep:!0});return{data:e}}))}export{d as defineMvuDataStore};
//# sourceMappingURL=mvu.js.map