import{compare as t}from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import{jsonrepair as r}from'https://testingcf.jsdelivr.net/npm/jsonrepair/+esm';import{toDotPath as e}from'https://testingcf.jsdelivr.net/npm/zod/v4/core/+esm';var n={};function o(t,r){return t.length=0,t.push(...r),t}function s(t,r){return _.mergeWith(t,r,(t,r)=>_.isArray(r)?r:void 0)}function i(t,r){if(0===t.length)return[];const e=[[t[0]]];for(const[n,o]of _.zip(_.dropRight(t),_.drop(t)))r(n,o)?e[e.length-1].push(o):e.push([o]);return e}function a(t,r){if(!t)return null;const e=(t,e)=>(r&&(t=substitudeMacros(t)),new RegExp(t,e));try{const r=t.match(/\/(.+)\/([a-z]*)/i);if(!r)return e(_.escapeRegExp(t),'i');if(r[2]&&!/^(?!.*?(.).*?\1)[gmixXsuUAJ]+$/.test(r[3]))return e(t,'i');let n=r[2]??'';return _.pull(n,'g'),-1===n.indexOf('i')&&(n+='i'),e(r[1],n)}catch{return null}}function c(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(t){const r=16*Math.random()|0;return('x'===t?r:3&r|8).toString(16)})}async function u(r,e){t(await getTavernHelperVersion(),r,'<')&&toastr.error(`'${e}' 需要酒馆助手版本 >= '${r}'`,'版本不兼容')}function p(t){return _([...t.issues]).sortBy(t=>t.path?.length??0).flatMap(t=>{const r=[`✖ ${t.message}`];return t.path?.length&&r.push(`  → 路径: ${e(t.path)}`),void 0!==t.input&&r.push(`  → 输入: ${JSON.stringify(t.input)}`),r}).join('\n')}function x(t){return YAML.stringify(t,{blockQuote:'literal'})}function f(t){const e=/^[[{]/s.test(t.trimStart());try{return e?JSON.parse(r(t)):YAML.parseDocument(t,{merge:!0}).toJS()}catch(n){try{return e?YAML.parseDocument(t,{merge:!0}).toJS():JSON.parse(r(t))}catch(r){const o=t=>t instanceof Error?`${t.stack?t.stack:t.message}`:String(t),s={字符串内容:t};throw _.set(s,e?'JSON错误信息':'YAML错误信息',o(n)),_.set(s,e?'YAML错误信息':'JSON错误信息',o(r)),new Error(x({[`要解析的字符串不是有效的 ${e?'JSON/YAML':'YAML/JSON'} 格式`]:s}))}}}function l(t){const r=(new TextEncoder).encode(t),e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=255-r[t];let n='';for(let t=0;t<e.length;t++){n+=e[t].toString(16).padStart(2,'0')}return n}n.d=(t,r)=>{for(var e in r)n.o(r,e)&&!n.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},n.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);export{o as assignInplace,u as checkMinimumVersion,i as chunkBy,s as correctlyMerge,l as getComplementString,x as literalYamlify,f as parseString,p as prettifyErrorWithInput,a as regexFromString,c as uuidv4};
//# sourceMappingURL=common.js.map