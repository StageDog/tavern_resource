import{detailedDiff as e}from'https://testingcf.jsdelivr.net/npm/deep-object-diff/+esm';function t(e,t){_.set(e,'preset_settings_openai',t),$('#settings_preset_openai option').filter(function(){return $(this).text()===t}).prop('selected',!0)}$(()=>{eventOn(tavern_events.OAI_PRESET_CHANGED_BEFORE,async n=>{const s=getPreset('in_use'),r=getPreset(n.presetNameBefore);if(_.isEqual(s,r))return;const i=e(r,s),a=await SillyTavern.callGenericPopup(builtin.renderMarkdown(`'${n.presetNameBefore}' 预设存在以下内容还未保存, 是否切换成 '${n.presetName}' 预设?\n\`\`\`yaml\n${YAML.stringify(_.pickBy(i,e=>!_.isEmpty(e)))}\n\`\`\``),SillyTavern.POPUP_TYPE.CONFIRM,'',{leftAlign:!0,okButton:'保存并切换',cancelButton:'取消',customButtons:['直接切换'],wide:!0});if(a!==SillyTavern.POPUP_RESULT.CUSTOM1&&2!==a){if(a===SillyTavern.POPUP_RESULT.AFFIRMATIVE)return await n.savePreset(n.presetNameBefore,n.settings,!1),void t(n.settings,n.presetNameBefore);Object.keys(n.preset).forEach(e=>_.unset(n.preset,e)),t(n.settings,n.presetNameBefore)}})});
//# sourceMappingURL=index.js.map