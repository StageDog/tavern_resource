{"version":3,"file":"index.js","mappings":"AAAA,MAAM,EAA+BA,ECA/BC,EAAW,EAAAD,EAAEE,OAAO,CACtB,OAAQ,EAAAF,EAAEG,SAASC,QAAQ,OAE/B,IAAIC,EAgBJ,SAASC,EAAeC,GACpB,MAAMC,EAAiBD,EAAME,eACK,oBAA7BD,EAAeE,WAAgE,eAA7BF,EAAeE,YAClEF,EAAeG,MACfH,EAAeG,KAAKC,QAlBnBP,IACDA,EAAWJ,EAASY,MAAMC,aAAa,CAAEC,KAAM,SAAUC,UAAWC,iBACpEC,gBAAgBb,EAAU,CAAEU,KAAM,SAAUC,UAAWC,iBAEpDZ,GAcyC,SAC5CG,EAAeW,iBACfX,EAAeY,kBAdvB,SAA+BC,GAC3B,MAAMC,EAAO,IAAIC,KAAK,CAACF,GAAO,YACxBG,EAAgB,IAAIC,aAC1BD,EAAcE,MAAMC,IAAIL,GACxB,MAAMM,EAAmBC,EAAE,oBAC3BD,EAAiBE,KAAK,QAASN,EAAcO,OAC7CH,EAAiB,GAAGI,cAAc,IAAIC,MAAM,UAChD,CAQQC,CAAsB1B,EAAeG,MAE7C,CACA,MAAMwB,EAAYN,EAAE,kBAAkBO,QACtCP,EAAE,KACEM,EAAUE,GAAG,cAAe/B,KAEhCuB,EAAES,QAAQD,GAAG,WAAY,KACrBF,EAAUE,GAAG,cAAe/B","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/酒馆助手/粘贴文本转为附加文件/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","const Settings = z.object({\n    触发字数下限: z.number().default(400),\n});\nlet settings;\nfunction get_settings() {\n    if (!settings) {\n        settings = Settings.parse(getVariables({ type: 'script', script_id: getScriptId() }));\n        insertVariables(settings, { type: 'script', script_id: getScriptId() });\n    }\n    return settings;\n}\nfunction attach_file_from_text(text) {\n    const file = new File([text], 'text.txt');\n    const data_transfer = new DataTransfer();\n    data_transfer.items.add(file);\n    const $file_form_input = $('#file_form_input');\n    $file_form_input.prop('files', data_transfer.files);\n    $file_form_input[0].dispatchEvent(new Event('change'));\n}\nfunction on_beforeinput(event) {\n    const original_event = event.originalEvent;\n    if ((original_event.inputType === 'insertFromPaste' || original_event.inputType === 'insertText') &&\n        original_event.data &&\n        original_event.data.length > get_settings().触发字数下限) {\n        original_event.preventDefault();\n        original_event.stopPropagation();\n        attach_file_from_text(original_event.data);\n    }\n}\nconst text_area = $('#send_textarea').first();\n$(() => {\n    text_area.on('beforeinput', on_beforeinput);\n});\n$(window).on('pagehide', () => {\n    text_area.on('beforeinput', on_beforeinput);\n});\nexport {};\n"],"names":["z","Settings","object","number","default","settings","on_beforeinput","event","original_event","originalEvent","inputType","data","length","parse","getVariables","type","script_id","getScriptId","insertVariables","preventDefault","stopPropagation","text","file","File","data_transfer","DataTransfer","items","add","$file_form_input","$","prop","files","dispatchEvent","Event","attach_file_from_text","text_area","first","on","window"],"sourceRoot":""}