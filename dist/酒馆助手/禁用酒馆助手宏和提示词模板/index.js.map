{"version":3,"file":"index.js","mappings":"AAAO,SAASA,EAAwBC,GAEtC,MAAMC,EAAgCC,EAAE,iCACpCD,EAA8BE,OAAS,GAAKF,EAA8BG,KAAK,cAAgBJ,GACjGC,EAA8BG,KAAK,WAAYJ,GAAQ,GAAGK,cAAc,IAAIC,MAAM,UAIpF,MAAMC,EAAqBL,EAAE,yCACzBK,EAAmBJ,OAAS,GAAKI,EAAmBH,KAAK,cAAgBJ,GAC3EO,EAAmBC,QAAQ,SAG7B,MAAMC,EAAcP,EAAE,eAClBO,EAAYN,OAAS,GAAKM,EAAYL,KAAK,aAAeJ,GAC5DS,EAAYL,KAAK,UAAWJ,GAAQ,GAAGK,cAAc,IAAIC,MAAM,SAEnE,CCdAJ,EAAE,MCDKQ,eAA0BC,GAC/B,MAAMC,QAAeC,MAAMF,GAC3B,IAAKC,EAAOE,GACV,OAAO,EAET,MAAMC,QAAoBH,EAAOI,OACjCC,kBAAkBF,EAEpB,CDNEG,CACE,+FAEFnB,GAAwB,GAExBoB,QAAQC,eAAe,iBAAkB,KACvCrB,GAAwB,KAE1BoB,QAAQC,eAAe,iBAAkB,KACvCrB,GAAwB,KAG1B,MAAMsB,EAA2BC,EAAEC,SACjC,KACE,MAAMC,EAAUC,mBAChB,IAAIC,EACJ,MAAMC,EAAkBH,EAAQI,KAC9BF,GAA0B,kBAAhBA,EAAOG,MAA4C,kBAAhBH,EAAOG,MAEjDF,EAIHD,EAASC,GAHTD,EAAS,CAAEG,KAAM,gBAAiBC,SAAS,GAC3CN,EAAQO,KAAKL,IAKf,MAAMM,EAAc9B,EAAE,wEAAwEE,KAAK,WAE/F4B,KADkC,kBAAhBN,EAAOG,QAK3BH,EAAOG,KADLG,EACY,gBAEA,gBAEhBC,qBAAqBT,KAEvB,IACA,CAAEU,UAAU,IAEdf,QAAQgB,cAAcC,iBAAkBf,GACxCA,MAEFnB,EAAEmC,QAAQC,GAAG,WAAY,IAAMvC,GAAwB","sources":["src://tavern_helper_template/src/酒馆助手/禁用酒馆助手宏和提示词模板/toggle.ts","src://tavern_helper_template/src/酒馆助手/禁用酒馆助手宏和提示词模板/index.ts","src://tavern_helper_template/util/script.ts"],"sourcesContent":["export function toggleExtensionSettings(enable: boolean) {\n  // 酒馆助手 3.0\n  const $macro_replace_disable_toggle = $('#macro-replace-disable-toggle');\n  if ($macro_replace_disable_toggle.length > 0 && $macro_replace_disable_toggle.prop('checked') !== !enable) {\n    $macro_replace_disable_toggle.prop('checked', !enable)[0].dispatchEvent(new Event('click'));\n  }\n\n  // 酒馆助手 4.0\n  const $TH_macro_disabled = $('#TH-macro-enabled, #TH-macro-disabled');\n  if ($TH_macro_disabled.length > 0 && $TH_macro_disabled.prop('checked') !== !enable) {\n    $TH_macro_disabled.trigger('click');\n  }\n\n  const $pt_enabled = $('#pt_enabled');\n  if ($pt_enabled.length > 0 && $pt_enabled.prop('checked') !== enable) {\n    $pt_enabled.prop('checked', enable)[0].dispatchEvent(new Event('click'));\n  }\n}\n","import { loadReadme } from '@util/script';\nimport { toggleExtensionSettings } from './toggle';\n\n$(() => {\n  loadReadme(\n    'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/禁用酒馆助手宏和提示词模板/README.md',\n  );\n  toggleExtensionSettings(false);\n\n  eventOn(getButtonEvent('禁用酒馆助手宏和提示词模板'), () => {\n    toggleExtensionSettings(false);\n  });\n  eventOn(getButtonEvent('启用酒馆助手宏和提示词模板'), () => {\n    toggleExtensionSettings(true);\n  });\n\n  const checkStatusAndSetButtons = _.throttle(\n    () => {\n      const buttons = getScriptButtons();\n      let button: ScriptButton;\n      const possible_button = buttons.find(\n        button => button.name === '启用酒馆助手宏和提示词模板' || button.name === '禁用酒馆助手宏和提示词模板',\n      );\n      if (!possible_button) {\n        button = { name: '启用酒馆助手宏和提示词模板', visible: true };\n        buttons.push(button);\n      } else {\n        button = possible_button;\n      }\n\n      const is_disabled = $('#macro-replace-disable-toggle, #TH-macro-enabled, #TH-macro-disabled').prop('checked');\n      const should_enable = button.name === '启用酒馆助手宏和提示词模板';\n      if (is_disabled === should_enable) {\n        return;\n      }\n      if (is_disabled) {\n        button.name = '启用酒馆助手宏和提示词模板';\n      } else {\n        button.name = '禁用酒馆助手宏和提示词模板';\n      }\n      replaceScriptButtons(buttons);\n    },\n    1000,\n    { trailing: false },\n  );\n  eventOn(tavern_events.SETTINGS_UPDATED, checkStatusAndSetButtons);\n  checkStatusAndSetButtons();\n});\n$(window).on('pagehide', () => toggleExtensionSettings(true));\n","import iframe_srcdoc from './iframe_srcdoc.html';\n\nexport async function loadReadme(url: string): Promise<boolean> {\n  const readme = await fetch(url);\n  if (!readme.ok) {\n    return false;\n  }\n  const readme_text = await readme.text();\n  replaceScriptInfo(readme_text);\n  return true;\n}\n\nexport function teleportStyle(\n  append_to: JQuery.Selector | JQuery.htmlString | JQuery.TypeOrArray<Element | DocumentFragment> | JQuery = 'head',\n): { destroy: () => void } {\n  const $div = $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo(append_to);\n\n  return {\n    destroy: () => $div.remove(),\n  };\n}\n\nexport function createScriptIdIframe(): JQuery<HTMLIFrameElement> {\n  return $(`<iframe>`).attr({\n    script_id: getScriptId(),\n    frameborder: 0,\n    srcdoc: iframe_srcdoc,\n  }) as JQuery<HTMLIFrameElement>;\n}\n\nexport function createScriptIdDiv(): JQuery<HTMLDivElement> {\n  return $('<div>').attr('script_id', getScriptId()) as JQuery<HTMLDivElement>;\n}\n\nexport function reloadOnChatChange(): EventOnReturn {\n  let chat_id = SillyTavern.getCurrentChatId();\n  return eventOn(tavern_events.CHAT_CHANGED, new_chat_id => {\n    if (chat_id !== new_chat_id) {\n      chat_id = new_chat_id;\n      window.location.reload();\n    }\n  });\n}\n"],"names":["toggleExtensionSettings","enable","$macro_replace_disable_toggle","$","length","prop","dispatchEvent","Event","$TH_macro_disabled","trigger","$pt_enabled","async","url","readme","fetch","ok","readme_text","text","replaceScriptInfo","loadReadme","eventOn","getButtonEvent","checkStatusAndSetButtons","_","throttle","buttons","getScriptButtons","button","possible_button","find","name","visible","push","is_disabled","replaceScriptButtons","trailing","tavern_events","SETTINGS_UPDATED","window","on"],"ignoreList":[],"sourceRoot":""}