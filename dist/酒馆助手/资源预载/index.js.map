{"version":3,"file":"index.js","mappings":"AAAA,MAAM,EAA+BA,ECA/BC,EAAW,EAAAD,EAAEE,OAAO,CACtB,KAAM,EAAAF,EAAEG,SAASC,QAAQ,MAEvBC,EAAkB,CAAEC,KAAM,SAAUC,UAAWC,eAoBrD,SAASC,EAAsBC,GAC3B,OAAOC,EAAE,SACJC,KAAK,KAAM,mBAAmBF,EAASG,SACvCC,OAAOJ,EAASK,OAAOC,IAAIC,GAASN,EAAE,UAAUC,KAAK,CACtDM,IAAK,WACLC,GAAI,QACJC,KAAMH,KAEd,CAMAN,EAAEU,UACE,MACMC,EAnCV,WACI,MAAMC,EAAWtB,EAASuB,MAAMC,aAAapB,IAE7C,OADAqB,gBAAgBH,EAAUlB,GACnBsB,EAAEC,oBACJC,OAAOC,GAASA,EAAMC,SAAWD,EAAME,YAAYC,SAAS,QAC5DjB,IAAIc,IAAS,CACdjB,MAAOiB,EAAME,YAAYE,QAAQ,MAAO,IAAIC,WAAW,UAAW,IAClEC,QAASN,EAAMO,kBAEdC,OAAO,CAAC,CAAEzB,MAAO,OAAQuB,QAASb,EAAS,QAC3CP,IAAI,EAAGH,QAAOuB,cAAc,CAC7BvB,QACAE,OAAQqB,EACHG,MAAM,MACNvB,IAAIC,GAASA,EAAMuB,QACnBX,OAAOZ,KAAWA,MAEtBwB,OACT,CAgBuBC,GACe1B,IAAIP,IAP1C,SAA6BkC,GACzB,MAAMC,EAAOjC,EAAE,OAAQkC,OAAOC,OAAOC,UACrCH,EAAKI,KAAK,oBAAoBC,SAC9BL,EAAK9B,OAAO6B,EAChB,CAIIO,CAAoBvC,EAAE,SAASC,KAAK,KAAM,mBAAmBE,OAAOQ","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/酒馆助手/资源预载/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","const Settings = z.object({\n    资源预载: z.string().default(''),\n});\nconst variable_option = { type: 'script', script_id: getScriptId() };\nfunction get_prefetches() {\n    const settings = Settings.parse(getVariables(variable_option));\n    insertVariables(settings, variable_option);\n    return _(getTavernRegexes())\n        .filter(regex => regex.enabled && regex.script_name.includes('预载-'))\n        .map(regex => ({\n        title: regex.script_name.replace('预载-', '').replaceAll(/【.+?】/gs, ''),\n        content: regex.replace_string,\n    }))\n        .concat([{ title: '脚本变量', content: settings.资源预载 }])\n        .map(({ title, content }) => ({\n        title,\n        assets: content\n            .split('\\n')\n            .map(asset => asset.trim())\n            .filter(asset => !!asset),\n    }))\n        .value();\n}\nfunction extract_prefetch_node(prefetch) {\n    return $('<div>')\n        .attr('id', `script_prefetch-${prefetch.title}`)\n        .append(prefetch.assets.map(asset => $('<link>').attr({\n        rel: 'prefetch',\n        as: 'image',\n        href: asset,\n    })));\n}\nfunction reappend_prefetches(nodes) {\n    const head = $('head', window.parent.document);\n    head.find('#script_prefetch').remove();\n    head.append(nodes);\n}\n$(async () => {\n    const prefetches = get_prefetches();\n    const prefetch_nodes = prefetches.map(extract_prefetch_node);\n    reappend_prefetches($('<div>').attr('id', 'script_prefetch').append(prefetch_nodes));\n});\nexport {};\n"],"names":["z","Settings","object","string","default","variable_option","type","script_id","getScriptId","extract_prefetch_node","prefetch","$","attr","title","append","assets","map","asset","rel","as","href","async","prefetch_nodes","settings","parse","getVariables","insertVariables","_","getTavernRegexes","filter","regex","enabled","script_name","includes","replace","replaceAll","content","replace_string","concat","split","trim","value","get_prefetches","nodes","head","window","parent","document","find","remove","reappend_prefetches"],"ignoreList":[],"sourceRoot":""}