{"version":3,"file":"index.js","mappings":"AAAA,MAAM,EAA+BA,ECA/BC,EAAW,EAAAD,EAAEE,OAAO,CACtB,KAAM,EAAAF,EAAEG,SAASC,QAAQ,MAEvBC,EAAkB,CAAEC,KAAM,SAAUC,UAAWC,eAoBrD,SAASC,EAAqBC,GAC1B,OAAOC,EAAE,SACJC,KAAK,KAAM,kBAAkBF,EAAQG,SACrCC,OAAOJ,EAAQK,OAAOC,IAAIC,GAASN,EAAE,UAAUC,KAAK,MAAO,WAAWA,KAAK,OAAQK,GAAOL,KAAK,KAAM,UAC9G,CAMAD,EAAEO,UACE,MACMC,EA/BV,WACI,MAAMC,EAAWnB,EAASoB,MAAMC,aAAajB,IAE7C,OADAkB,gBAAgBH,EAAUf,GACnBmB,EAAEC,oBACJC,OAAOC,GAASA,EAAMC,SAAWD,EAAME,YAAYC,SAAS,QAC5Dd,IAAIW,IAAS,CACdd,MAAOc,EAAME,YAAYE,QAAQ,MAAO,IAAIC,WAAW,UAAW,IAClEC,QAASN,EAAMO,kBAEdC,OAAO,CAAC,CAAEtB,MAAO,OAAQoB,QAASb,EAAS,QAC3CJ,IAAI,EAAGH,QAAOoB,cAAc,CAC7BpB,QACAE,OAAQkB,EACHG,MAAM,MACNpB,IAAIC,GAASA,EAAMoB,QACnBX,OAAOT,KAAWA,MAEtBqB,OACT,CAYqBC,GACcvB,IAAIP,IAPvC,SAA2B+B,GACvB,MAAMC,EAAO9B,EAAE,OAAQ+B,OAAOC,OAAOC,UACrCH,EAAKI,KAAK,mBAAmBC,SAC7BL,EAAK3B,OAAO0B,EAChB,CAIIO,CAAkBpC,EAAE,SAASC,KAAK,KAAM,kBAAkBE,OAAOK","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/酒馆助手/资源预载/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","const Settings = z.object({\n    资源预载: z.string().default(''),\n});\nconst variable_option = { type: 'script', script_id: getScriptId() };\nfunction get_preloads() {\n    const settings = Settings.parse(getVariables(variable_option));\n    insertVariables(settings, variable_option);\n    return _(getTavernRegexes())\n        .filter(regex => regex.enabled && regex.script_name.includes('预载-'))\n        .map(regex => ({\n        title: regex.script_name.replace('预载-', '').replaceAll(/【.+?】/gs, ''),\n        content: regex.replace_string,\n    }))\n        .concat([{ title: '脚本变量', content: settings.资源预载 }])\n        .map(({ title, content }) => ({\n        title,\n        assets: content\n            .split('\\n')\n            .map(asset => asset.trim())\n            .filter(asset => !!asset),\n    }))\n        .value();\n}\nfunction extract_preload_node(preload) {\n    return $('<div>')\n        .attr('id', `script_preload-${preload.title}`)\n        .append(preload.assets.map(asset => $('<link>').attr('rel', 'preload').attr('href', asset).attr('as', 'image')));\n}\nfunction reappend_preloads(nodes) {\n    const head = $('head', window.parent.document);\n    head.find('#script_preload').remove();\n    head.append(nodes);\n}\n$(async () => {\n    const preloads = get_preloads();\n    const preload_nodes = preloads.map(extract_preload_node);\n    reappend_preloads($('<div>').attr('id', 'script_preload').append(preload_nodes));\n});\nexport {};\n"],"names":["z","Settings","object","string","default","variable_option","type","script_id","getScriptId","extract_preload_node","preload","$","attr","title","append","assets","map","asset","async","preload_nodes","settings","parse","getVariables","insertVariables","_","getTavernRegexes","filter","regex","enabled","script_name","includes","replace","replaceAll","content","replace_string","concat","split","trim","value","get_preloads","nodes","head","window","parent","document","find","remove","reappend_preloads"],"sourceRoot":""}