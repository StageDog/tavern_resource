{"version":3,"file":"index.js","mappings":"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","sources":["webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Field.vue?fafa","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/HelpIcon.vue?d959","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Section.vue?16ce","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/api.js","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Field.vue?a8b7","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/HelpIcon.vue?9783","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Section.vue?9ef8","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/listToStyles.js","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/util/common.ts","src://tavern_helper_template/util/script.ts","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/store.ts","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Field.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Field.vue?253e","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/HelpIcon.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/HelpIcon.vue?3843","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Item.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Item.vue?19cf","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Section.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Section.vue?ad83","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Select.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Select.vue?a1fd","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/help/chat_history.md?ea6b","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/ChatHistory.vue?3bba","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/ChatHistory.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/help/delimiter.md?d26a","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Delimiter.vue?0ba5","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Delimiter.vue","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Checkbox.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/component/Checkbox.vue?9b21","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/help/depth_injection.md?748e","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/DepthInjection.vue?f56c","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/DepthInjection.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/help/stop.md?6952","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Stop.vue?a858","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Stop.vue","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Panel.vue","webpack://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/Panel.vue?025d","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/panel/index.ts","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/squash.ts","src://tavern_helper_template/src/酒馆助手/压缩相邻消息/index.ts"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.TR-field[data-v-75b81b74]{padding:0.45rem 0.6rem;gap:0.25rem;border:1px solid color-mix(in srgb,var(--SmartThemeBorderColor,rgba(45,45,45,1)) 35%,transparent);border-radius:10px;background-color:color-mix(in srgb,var(--SmartThemeBlurTintColor,rgba(31,31,31,1)) 55%,transparent)}.TR-field__label[data-v-75b81b74]{display:inline-flex;align-items:center;gap:0.35rem;font-weight:600;opacity:0.95}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/酒馆助手/压缩相邻消息/panel/component/Field.vue\"],\"names\":[],\"mappings\":\"AAeA,2BACE,sBAAuB,CACvB,WAAY,CACZ,iGAAwG,CACxG,kBAAmB,CACnB,mGACF,CAEA,kCACE,mBAAoB,CACpB,kBAAmB,CACnB,WAAY,CACZ,eAAgB,CAChB,YACF\",\"sourcesContent\":[\"<template>\\n  <div class=\\\"TR-field flex-container flexFlowColumn\\\">\\n    <label class=\\\"TR-field__label\\\">\\n      <span>{{ label }}</span>\\n      <slot name=\\\"label-suffix\\\" />\\n    </label>\\n    <slot />\\n  </div>\\n</template>\\n\\n<script setup lang=\\\"ts\\\">\\ndefineProps<{ label: string }>();\\n</script>\\n\\n<style scoped>\\n.TR-field {\\n  padding: 0.45rem 0.6rem;\\n  gap: 0.25rem;\\n  border: 1px solid color-mix(in srgb, var(--SmartThemeBorderColor, rgba(45, 45, 45, 1)) 35%, transparent);\\n  border-radius: 10px;\\n  background-color: color-mix(in srgb, var(--SmartThemeBlurTintColor, rgba(31, 31, 31, 1)) 55%, transparent);\\n}\\n\\n.TR-field__label {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: 0.35rem;\\n  font-weight: 600;\\n  opacity: 0.95;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.TR-help-icon[data-v-43141e14]{cursor:pointer}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/酒馆助手/压缩相邻消息/panel/component/HelpIcon.vue\"],\"names\":[],\"mappings\":\"AAsBA,+BACE,cACF\",\"sourcesContent\":[\"<template>\\n  <i\\n    class=\\\"fa-solid fa-circle-question fa-sm note-link-span TR-help-icon\\\"\\n    role=\\\"button\\\"\\n    tabindex=\\\"0\\\"\\n    @click=\\\"showHelpPopup(help)\\\"\\n  />\\n</template>\\n\\n<script setup lang=\\\"ts\\\">\\ndefineProps<{ help: string }>();\\n\\nfunction showHelpPopup(content: string) {\\n  SillyTavern.callGenericPopup(content, SillyTavern.POPUP_TYPE.TEXT, '', {\\n    allowVerticalScrolling: true,\\n    leftAlign: true,\\n    wide: true,\\n  });\\n}\\n</script>\\n\\n<style scoped>\\n.TR-help-icon {\\n  cursor: pointer;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.TR-section[data-v-399ec098]{border:1px solid var(--SmartThemeBorderColor,rgba(45,45,45,1));border-radius:10px;padding:0.6rem 0.75rem;gap:0.45rem;background-color:rgba(0,0,0,0.08);background-color:color-mix(in srgb,var(--SmartThemeBlurTintColor,rgba(31,31,31,1)) 75%,transparent)}.TR-section__content[data-v-399ec098]{gap:0.5rem}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/酒馆助手/压缩相邻消息/panel/component/Section.vue\"],\"names\":[],\"mappings\":\"AAmBA,6BACE,8DAAmE,CACnE,kBAAmB,CACnB,sBAAuB,CACvB,WAAY,CACZ,iCAAqC,CACrC,mGACF,CAEA,sCACE,UACF\",\"sourcesContent\":[\"<template>\\n  <div class=\\\"TR-section flex-container flexFlowColumn\\\">\\n    <div class=\\\"TR-section__title\\\">\\n      <strong>\\n        <span>{{ label }}</span>\\n      </strong>\\n      <slot name=\\\"label-suffix\\\" />\\n    </div>\\n    <div class=\\\"TR-section__content flex-container flexFlowColumn\\\">\\n      <slot />\\n    </div>\\n  </div>\\n</template>\\n\\n<script setup lang=\\\"ts\\\">\\ndefineProps<{ label: string }>();\\n</script>\\n\\n<style scoped>\\n.TR-section {\\n  border: 1px solid var(--SmartThemeBorderColor, rgba(45, 45, 45, 1));\\n  border-radius: 10px;\\n  padding: 0.6rem 0.75rem;\\n  gap: 0.45rem;\\n  background-color: rgba(0, 0, 0, 0.08);\\n  background-color: color-mix(in srgb, var(--SmartThemeBlurTintColor, rgba(31, 31, 31, 1)) 75%, transparent);\\n}\\n\\n.TR-section__content {\\n  gap: 0.5rem;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Field.vue?vue&type=style&index=0&id=75b81b74&scoped=true&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"42f68fa0\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Field.vue?vue&type=style&index=0&id=75b81b74&scoped=true&lang=css\", function() {\n     var newContent = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Field.vue?vue&type=style&index=0&id=75b81b74&scoped=true&lang=css\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./HelpIcon.vue?vue&type=style&index=0&id=43141e14&scoped=true&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"624f9279\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./HelpIcon.vue?vue&type=style&index=0&id=43141e14&scoped=true&lang=css\", function() {\n     var newContent = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./HelpIcon.vue?vue&type=style&index=0&id=43141e14&scoped=true&lang=css\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Section.vue?vue&type=style&index=0&id=399ec098&scoped=true&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6a73a42c\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Section.vue?vue&type=style&index=0&id=399ec098&scoped=true&lang=css\", function() {\n     var newContent = require(\"!!../../../../../node_modules/.pnpm/css-loader@7.1.3_webpack@5.105.0/node_modules/css-loader/dist/cjs.js??clonedRuleSet-880.use[1]!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.105.0/node_modules/postcss-loader/dist/cjs.js!../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./Section.vue?vue&type=style&index=0&id=399ec098&scoped=true&lang=css\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { compare } from 'compare-versions';\nimport JSON5 from 'json5';\nimport { jsonrepair } from 'jsonrepair';\nimport { toDotPath } from 'zod/v4/core';\n\nexport function assignInplace<T>(destination: T[], new_array: T[]): T[] {\n  destination.length = 0;\n  destination.push(...new_array);\n  return destination;\n}\n\nexport function chunkBy<T>(array: T[], predicate: (lhs: T, rhs: T) => boolean): T[][] {\n  if (array.length === 0) {\n    return [];\n  }\n\n  const chunks: T[][] = [[array[0]]];\n  for (const [lhs, rhs] of _.zip(_.dropRight(array), _.drop(array))) {\n    if (predicate(lhs!, rhs!)) {\n      chunks[chunks.length - 1].push(rhs!);\n    } else {\n      chunks.push([rhs!]);\n    }\n  }\n  return chunks;\n}\n\nexport function regexFromString(input: string, replace_macros?: boolean): RegExp | null {\n  if (!input) {\n    return null;\n  }\n  const makeRegex = (pattern: string, flags: string) => {\n    if (replace_macros) {\n      pattern = substitudeMacros(pattern);\n    }\n    return new RegExp(pattern, flags);\n  };\n  try {\n    const match = input.match(/\\/(.+)\\/([a-z]*)/i);\n    if (!match) {\n      return makeRegex(_.escapeRegExp(input), 'i');\n    }\n    if (match[2] && !/^(?!.*?(.).*?\\1)[gmixXsuUAJ]+$/.test(match[3])) {\n      return makeRegex(input, 'i');\n    }\n    let flags = match[2] ?? '';\n    _.pull(flags, 'g');\n    if (flags.indexOf('i') === -1) {\n      flags = flags + 'i';\n    }\n    return makeRegex(match[1], flags);\n  } catch {\n    return null;\n  }\n}\n\nexport function uuidv4(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport async function checkMinimumVersion(expected: string, title: string) {\n  if (compare(await getTavernHelperVersion(), expected, '<')) {\n    toastr.error(`'${title}' 需要酒馆助手版本 >= '${expected}'`, '版本不兼容');\n  }\n}\n\nexport function prettifyErrorWithInput(error: z.ZodError) {\n  return _([...error.issues])\n    .sortBy(issue => issue.path?.length ?? 0)\n    .flatMap(issue => {\n      const lines = [`✖ ${issue.message}`];\n      if (issue.path?.length) {\n        lines.push(`  → 路径: ${toDotPath(issue.path)}`);\n      }\n      if (issue.input !== undefined) {\n        lines.push(`  → 输入: ${JSON.stringify(issue.input)}`);\n      }\n      return lines;\n    })\n    .join('\\n');\n}\n\nexport function literalYamlify(value: any) {\n  return YAML.stringify(value, { blockQuote: 'literal' });\n}\n\nexport function parseString(content: string): any {\n  let parsed: unknown;\n  try {\n    parsed = YAML.parseDocument(content, { merge: true }).toJS();\n  } catch (yaml_error) {\n    try {\n      // eslint-disable-next-line import-x/no-named-as-default-member\n      parsed = JSON5.parse(content);\n    } catch (json5_error) {\n      try {\n        parsed = JSON.parse(jsonrepair(content));\n      } catch (json_error) {\n        const toError = (error: unknown) => (error instanceof Error ? error.message : String(error));\n        throw new Error(\n          literalYamlify({\n            ['要解析的字符串不是有效的 YAML/JSON 格式']: {\n              字符串内容: content,\n              YAML错误信息: toError(yaml_error),\n              JSON5错误信息: toError(json5_error),\n              尝试修复JSON时的错误信息: toError(json_error),\n            },\n          }),\n        );\n      }\n    }\n  }\n  return parsed;\n}\n\nexport function getComplementString(string: string) {\n  const encoder = new TextEncoder();\n  const bytes = encoder.encode(string);\n\n  const complemented = new Uint8Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    complemented[i] = 0xff - bytes[i];\n  }\n\n  let hex = '';\n  for (let i = 0; i < complemented.length; i++) {\n    const h = complemented[i].toString(16).padStart(2, '0');\n    hex += h;\n  }\n  return hex;\n}\n\nexport async function checkAndUpdateCharacter(name: string, latest_version: string, png_url: string): Promise<void> {\n  const current_version = (await getCharacter(name)).version.trim() || '0.0.0';\n  if (compare(current_version, latest_version, '>=')) {\n    return;\n  }\n  await importRawCharacter(name, await fetch(png_url).then(response => response.blob()));\n  replaceCharacter(name, { version: latest_version });\n  toastr.success(\n    `角色卡已自动更新到 '${latest_version.startsWith('v') ? latest_version : `v${latest_version}`}'`,\n    name,\n  );\n}\n","import iframe_srcdoc from './iframe_srcdoc.html';\n\nexport async function loadReadme(url: string): Promise<boolean> {\n  const readme = await fetch(url);\n  if (!readme.ok) {\n    return false;\n  }\n  const readme_text = await readme.text();\n  replaceScriptInfo(readme_text);\n  return true;\n}\n\nexport function teleportStyle(\n  append_to: JQuery.Selector | JQuery.htmlString | JQuery.TypeOrArray<Element | DocumentFragment> | JQuery = 'head',\n): { destroy: () => void } {\n  const $div = $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo(append_to);\n\n  return {\n    destroy: () => $div.remove(),\n  };\n}\n\nexport function createScriptIdIframe(): JQuery<HTMLIFrameElement> {\n  return $(`<iframe>`).attr({\n    script_id: getScriptId(),\n    frameborder: 0,\n    srcdoc: iframe_srcdoc,\n  }) as JQuery<HTMLIFrameElement>;\n}\n\nexport function createScriptIdDiv(): JQuery<HTMLDivElement> {\n  return $('<div>').attr('script_id', getScriptId()) as JQuery<HTMLDivElement>;\n}\n\nexport function reloadOnChatChange(): EventOnReturn {\n  let chat_id = SillyTavern.getCurrentChatId();\n  return eventOn(tavern_events.CHAT_CHANGED, new_chat_id => {\n    if (chat_id !== new_chat_id) {\n      chat_id = new_chat_id;\n      window.location.reload();\n    }\n  });\n}\n\nexport function registerAsUniqueScript(id: string): {\n  unregister: () => void;\n  getPreferredScriptId: () => string | undefined;\n  listenPreferenceState: (callback: (perferred_script_id: string) => void) => EventOnReturn;\n} {\n  const script_id = getScriptId();\n  const path = `th_unique_check.${id}`;\n\n  const getPreferredScriptId = () => {\n    const registered_scripts = _.get(window.parent, path, new Set<string>());\n    return _($('#tavern_helper').find('div[data-script-id]').toArray())\n      .map(element => String($(element).attr('data-script-id')))\n      .filter(element => registered_scripts.has(element))\n      .last();\n  };\n\n  _.update(window.parent, path, (value: Set<string> | undefined) => {\n    if (value === undefined) {\n      return new Set([script_id]);\n    }\n    value.add(script_id);\n    return value;\n  });\n  eventEmit(path, getPreferredScriptId());\n\n  return {\n    unregister: () => {\n      _.update(window.parent, path, (value: Set<string> | undefined) => {\n        if (value !== undefined) {\n          value.delete(script_id);\n        }\n        return value;\n      });\n      eventEmit(path, getPreferredScriptId());\n    },\n    getPreferredScriptId,\n    listenPreferenceState: (callback: (enabled_script_id: string) => void) => eventOn(path, callback),\n  };\n}\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { registerAsUniqueScript } from '@util/script';\nconst OldSettings = z\n    .object({\n    seperator: z\n        .object({\n        type: z.enum(['space', 'newline', 'double newline', 'custom']),\n        value: z.string(),\n    })\n        .transform(data => {\n        switch (data.type) {\n            case 'space':\n                data.value = ' ';\n                break;\n            case 'newline':\n                data.value = '\\n';\n                break;\n            case 'double newline':\n                data.value = '\\n\\n';\n                break;\n            case 'custom':\n                break;\n        }\n        return data;\n    }),\n    put_system_injection_after_chat_history: z.boolean(),\n    on_chat_history: z.object({\n        type: z.enum(['mixin', 'seperate', 'squash']),\n        squash_role: z.enum(['user', 'assistant', 'system']),\n        user_prefix: z.string(),\n        user_suffix: z.string(),\n        assistant_prefix: z.string(),\n        assistant_suffix: z.string(),\n        system_prefix: z.string(),\n        system_suffix: z.string(),\n    }),\n    stop_string: z.string(),\n})\n    .transform(data => {\n    return Settings.parse({\n        delimiter: data.seperator,\n        stop_string: data.stop_string,\n        depth_injection: {\n            threshold: 10,\n            above: {\n                enabled: data.put_system_injection_after_chat_history,\n                type: 'exclude',\n                placeholder: `{{压缩相邻消息::above_dx}}`,\n            },\n            below: {\n                enabled: data.put_system_injection_after_chat_history,\n                type: 'exclude',\n                placeholder: `{{压缩相邻消息::below_dx}}`,\n            },\n        },\n        chat_history: {\n            ...data.on_chat_history,\n            type: data.on_chat_history.type === 'squash' ? 'squash_into_one' : 'squash_nearby',\n        },\n    });\n});\nexport const Settings = z\n    .object({\n    delimiter: z\n        .object({\n        type: z.enum(['space', 'newline', 'double newline', 'custom']).default('double newline'),\n        value: z.string().default('\\n\\n'),\n    })\n        .prefault({})\n        .transform(data => {\n        switch (data.type) {\n            case 'space':\n                data.value = ' ';\n                break;\n            case 'newline':\n                data.value = '\\n';\n                break;\n            case 'double newline':\n                data.value = '\\n\\n';\n                break;\n            case 'custom':\n                break;\n        }\n        return data;\n    }),\n    stop_string: z.string().default('</observed_piece>').catch('</observed_piece>'),\n    depth_injection: z\n        .object({\n        threshold: z.number().int().min(1).default(10).catch(10),\n        above: z\n            .object({\n            enabled: z.boolean().default(false),\n            type: z.enum(['exclude', 'placeholder']).default('exclude'),\n            placeholder: z.string().default('{{压缩相邻消息::above_dx}}'),\n        })\n            .prefault({}),\n        below: z\n            .object({\n            enabled: z.boolean().default(false),\n            type: z.enum(['exclude', 'placeholder']).default('exclude'),\n            placeholder: z.string().default('{{压缩相邻消息::below_dx}}'),\n        })\n            .prefault({}),\n    })\n        .prefault({}),\n    chat_history: z\n        .object({\n        type: z.enum(['squash_nearby', 'squash_into_one']).default('squash_into_one'),\n        squash_role: z.enum(['user', 'assistant', 'system']).default('assistant'),\n        user_prefix: z.string().default('<observed_piece class=\"下段剧情指令\">\\n'),\n        user_suffix: z.string().default('\\n</observed_piece>'),\n        assistant_prefix: z.string().default('<observed_piece class=\"剧情\">\\n'),\n        assistant_suffix: z.string().default('\\n</observed_piece>'),\n        system_prefix: z.string().default('<observed_piece class=\"设定\">\\n'),\n        system_suffix: z.string().default('\\n</observed_piece>'),\n    })\n        .prefault({}),\n})\n    .prefault({});\nexport const useSettingsStore = defineStore('settings', () => {\n    const variables = getVariables({ type: 'script', script_id: getScriptId() });\n    const settings = ref((_.has(variables, 'seperator') ? OldSettings : Settings).parse(variables));\n    const should_enable = ref(false);\n    registerAsUniqueScript('压缩相邻消息').listenPreferenceState(preferred_script_id => {\n        should_enable.value = preferred_script_id === getScriptId();\n    });\n    watchEffect(() => {\n        replaceVariables(klona(settings.value), { type: 'script', script_id: getScriptId() });\n    });\n    const useEscapedNewline = (path) => {\n        return computed({\n            get: () => _.get(settings.value, path).replace(/\\n/g, '\\\\n'),\n            set: value => _.set(settings.value, path, value.replace(/\\\\n/g, '\\n')),\n        });\n    };\n    return { settings, should_enable, useEscapedNewline };\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"TR-field flex-container flexFlowColumn\" };\nconst _hoisted_2 = { class: \"TR-field__label\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Field',\n    props: {\n        label: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"label\", _hoisted_2, [\n                    _createElementVNode(\"span\", null, _toDisplayString(__props.label), 1 /* TEXT */),\n                    _renderSlot(_ctx.$slots, \"label-suffix\")\n                ]),\n                _renderSlot(_ctx.$slots, \"default\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Field.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Field.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Field.vue?vue&type=style&index=0&id=75b81b74&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-75b81b74\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'HelpIcon',\n    props: {\n        help: {}\n    },\n    setup(__props) {\n        function showHelpPopup(content) {\n            SillyTavern.callGenericPopup(content, SillyTavern.POPUP_TYPE.TEXT, '', {\n                allowVerticalScrolling: true,\n                leftAlign: true,\n                wide: true,\n            });\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"i\", {\n                class: \"fa-solid fa-circle-question fa-sm note-link-span TR-help-icon\",\n                role: \"button\",\n                tabindex: \"0\",\n                onClick: _cache[0] || (_cache[0] = ($event) => (showHelpPopup(__props.help)))\n            }));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./HelpIcon.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HelpIcon.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./HelpIcon.vue?vue&type=style&index=0&id=43141e14&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-43141e14\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderSlot as _renderSlot } from \"vue\";\nconst _hoisted_1 = { class: \"flex-container alignitemscenter\" };\nconst _hoisted_2 = { key: 0 };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Item',\n    props: {\n        label: {}\n    },\n    setup(__props) {\n        const props = __props;\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.label)\n                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString(__props.label), 1 /* TEXT */))\n                    : _createCommentVNode(\"v-if\", true),\n                _renderSlot(_ctx.$slots, \"default\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Item.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Item.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"TR-section flex-container flexFlowColumn\" };\nconst _hoisted_2 = { class: \"TR-section__title\" };\nconst _hoisted_3 = { class: \"TR-section__content flex-container flexFlowColumn\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Section',\n    props: {\n        label: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"strong\", null, [\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.label), 1 /* TEXT */)\n                    ]),\n                    _renderSlot(_ctx.$slots, \"label-suffix\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _renderSlot(_ctx.$slots, \"default\")\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Section.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Section.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Section.vue?vue&type=style&index=0&id=399ec098&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.105.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-399ec098\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives } from \"vue\";\n\nimport { computed } from 'vue';\nconst _hoisted_1 = [\"value\"];\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Select',\n    props: /*@__PURE__*/ _mergeModels({\n        options: {}\n    }, {\n        \"modelValue\": { required: true },\n        \"modelModifiers\": {},\n    }),\n    emits: [\"update:modelValue\"],\n    setup(__props) {\n        const model = _useModel(__props, \"modelValue\");\n        const props = __props;\n        const options = computed(() => props.options.map(option => (typeof option === 'string' ? { label: option, value: option } : option)));\n        return (_ctx, _cache) => {\n            return _withDirectives((_openBlock(), _createElementBlock(\"select\", {\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((model).value = $event)),\n                class: \"text_pole\"\n            }, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(options), ({ label, value }) => {\n                    return (_openBlock(), _createElementBlock(\"option\", {\n                        key: value,\n                        value: value\n                    }, _toDisplayString(label), 9 /* TEXT, PROPS */, _hoisted_1));\n                }), 128 /* KEYED_FRAGMENT */))\n            ], 512 /* NEED_PATCH */)), [\n                [_vModelSelect, model.value]\n            ]);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Select.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Select.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","// Module\nvar code = `<h1>处理聊天历史</h1> <p>酒馆的聊天历史 (预设中的 Chat History 条目) 记录了玩家和 AI 的每楼层提示词, 也就是实际游玩的内容.</p> <p>聊天记录往往是一问一答的: 一条用户输入、一条 AI 输出、一条用户输入……AI 团队可能针对这种对话进行了一些特殊训练, 而我们游玩酒馆恰因为这些训练出现问题 (出现八股、文风变差之类的).</p> <p>因此本脚本允许你对聊天历史进行额外处理:</p> <ul> <li>仅合并相邻同身份提示词: 将聊天历史中相邻且身份相同的提示词合并, 例如世界书条目 A 和 B 都插入到 D1 作为系统提示词, 则会被合并成一条提示词</li> <li><strong>压缩为单条提示词</strong>: 先合并相邻同身份提示词, 再将整个聊天历史压缩为一条提示词</li> </ul> <p>其中, 压缩为单条提示词就是为了避免受 AI 团队对人机对话的训练影响. 它将原本的一问一答附上相应的身份前后缀, 然后合并成一条提示词, 例如:</p> <pre><code class=\"language-text\">{{user}}:\n我输入了一段话\n\n剧情:\nAI 根据输入的话生成了一段文本\n\n{{user}}:\n我又输入了一段话\n</code></pre> <p>不过, 由于聊天记录被压缩成单条提示词发给 AI, AI 可能误认为它就该输出这样的一长串对话.</p> <p>为了避免它自问自答, 你可以在停止字符串中填入它应该在什么时候中止输出. (对于上面的例子, 我们可以填写 <code>{{user}}:</code> 作为停止字符串.)</p> `;\n// Exports\nexport default code;","/* unplugin-vue-components disabled */import script from \"./ChatHistory.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChatHistory.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, withCtx as _withCtx, isRef as _isRef, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\";\nimport { useSettingsStore } from '../store';\nimport Field from './component/Field.vue';\nimport HelpIcon from './component/HelpIcon.vue';\nimport Item from './component/Item.vue';\nimport Section from './component/Section.vue';\nimport Select from './component/Select.vue';\nimport chat_history_help from './help/chat_history.md';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ChatHistory',\n    setup(__props) {\n        const store = useSettingsStore();\n        const user_prefix_input = store.useEscapedNewline('chat_history.user_prefix');\n        const user_suffix_input = store.useEscapedNewline('chat_history.user_suffix');\n        const assistant_prefix_input = store.useEscapedNewline('chat_history.assistant_prefix');\n        const assistant_suffix_input = store.useEscapedNewline('chat_history.assistant_suffix');\n        const system_prefix_input = store.useEscapedNewline('chat_history.system_prefix');\n        const system_suffix_input = store.useEscapedNewline('chat_history.system_suffix');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(Section, { label: \"处理聊天历史\" }, {\n                \"label-suffix\": _withCtx(() => [\n                    _createVNode(HelpIcon, { help: _unref(chat_history_help) }, null, 8 /* PROPS */, [\"help\"])\n                ]),\n                default: _withCtx(() => [\n                    _createVNode(Select, {\n                        modelValue: _unref(store).settings.chat_history.type,\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(store).settings.chat_history.type) = $event)),\n                        options: [\n                            { label: '仅合并相邻同身份提示词', value: 'squash_nearby' },\n                            { label: '压缩为单条提示词', value: 'squash_into_one' },\n                        ]\n                    }, null, 8 /* PROPS */, [\"modelValue\"]),\n                    (_unref(store).settings.chat_history.type === 'squash_into_one')\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _createVNode(Field, { label: \"压缩后的提示词身份\" }, {\n                                default: _withCtx(() => [\n                                    _createVNode(Select, {\n                                        modelValue: _unref(store).settings.chat_history.squash_role,\n                                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(store).settings.chat_history.squash_role) = $event)),\n                                        options: [\n                                            { label: '用户', value: 'user' },\n                                            { label: '助手', value: 'assistant' },\n                                            { label: '系统', value: 'system' },\n                                        ]\n                                    }, null, 8 /* PROPS */, [\"modelValue\"])\n                                ]),\n                                _: 1 /* STABLE */\n                            }),\n                            _createVNode(Field, { label: \"提示词前后缀\" }, {\n                                default: _withCtx(() => [\n                                    _createVNode(Item, { label: \"用户前缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => (_isRef(user_prefix_input) ? (user_prefix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"[{{user}}:]\\\\n\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(user_prefix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    }),\n                                    _createVNode(Item, { label: \"用户后缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => (_isRef(user_suffix_input) ? (user_suffix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"\\\\n[/{{user}}:]\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(user_suffix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    }),\n                                    _createVNode(Item, { label: \"助手前缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => (_isRef(assistant_prefix_input) ? (assistant_prefix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"[剧情:]\\\\n\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(assistant_prefix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    }),\n                                    _createVNode(Item, { label: \"助手后缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => (_isRef(assistant_suffix_input) ? (assistant_suffix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"\\\\n[/剧情:]\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(assistant_suffix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    }),\n                                    _createVNode(Item, { label: \"系统前缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => (_isRef(system_prefix_input) ? (system_prefix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"[设定:]\\\\n\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(system_prefix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    }),\n                                    _createVNode(Item, { label: \"系统后缀\" }, {\n                                        default: _withCtx(() => [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => (_isRef(system_suffix_input) ? (system_suffix_input).value = $event : null)),\n                                                class: \"text_pole flex1 wide100p\",\n                                                type: \"text\",\n                                                autocomplete: \"off\",\n                                                placeholder: \"\\\\n[/设定:]\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(system_suffix_input)]\n                                            ])\n                                        ]),\n                                        _: 1 /* STABLE */\n                                    })\n                                ]),\n                                _: 1 /* STABLE */\n                            })\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","// Module\nvar code = `<h1>合并消息时的间隔文本</h1> <p>当发给 AI 的两条提示词合并时, 两条提示词的文本也会被合并. 但当文本合并时, 它们之间往往需要用额外文本间隔起来.</p> <p>例如, 一条提示词是:</p> <pre><code class=\"language-text\">用户:\n你好, 我是张三.\n</code></pre> <p>另一条提示词是:</p> <pre><code class=\"language-text\">助手:\n你好, 我是李四.\n</code></pre> <p>当这两条提示词合并时, 如果我们什么间隔文本都不加, 将会变成:</p> <pre><code class=\"language-text\">用户:\n你好, 我是张三.助手:\n你好, 我是李四.\n</code></pre> <p>显然这容易让 AI 产生误解, 因此我们需要在它们之间添加间隔文本.</p> <p>一般来说, 双换行是比较好的间隔文本, 因此脚本默认为你选择了双换行.</p> `;\n// Exports\nexport default code;","/* unplugin-vue-components disabled */import script from \"./Delimiter.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Delimiter.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, isRef as _isRef, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nimport { useSettingsStore } from '../store';\nimport HelpIcon from './component/HelpIcon.vue';\nimport Section from './component/Section.vue';\nimport Select from './component/Select.vue';\nimport delimiter_help from './help/delimiter.md';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Delimiter',\n    setup(__props) {\n        const store = useSettingsStore();\n        const delimiter = store.useEscapedNewline('delimiter.value');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(Section, { label: \"合并提示词时的间隔文本\" }, {\n                \"label-suffix\": _withCtx(() => [\n                    _createVNode(HelpIcon, { help: _unref(delimiter_help) }, null, 8 /* PROPS */, [\"help\"])\n                ]),\n                default: _withCtx(() => [\n                    _createVNode(Select, {\n                        modelValue: _unref(store).settings.delimiter.type,\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(store).settings.delimiter.type) = $event)),\n                        options: [\n                            { label: '空格', value: 'space' },\n                            { label: '换行', value: 'newline' },\n                            { label: '双换行', value: 'double newline' },\n                            { label: '自定义', value: 'custom' },\n                        ]\n                    }, null, 8 /* PROPS */, [\"modelValue\"]),\n                    (_unref(store).settings.delimiter.type === 'custom')\n                        ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                            key: 0,\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => (_isRef(delimiter) ? (delimiter).value = $event : null)),\n                            class: \"text_pole flex1 wide100p\",\n                            type: \"text\",\n                            autocomplete: \"off\"\n                        }, null, 512 /* NEED_PATCH */)), [\n                            [_vModelText, _unref(delimiter)]\n                        ])\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","import { useModel as _useModel, defineComponent as _defineComponent } from 'vue';\nimport { vModelCheckbox as _vModelCheckbox, createElementVNode as _createElementVNode, withDirectives as _withDirectives, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"checkbox_label\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Checkbox',\n    props: {\n        \"modelValue\": { type: Boolean, ...{ required: true } },\n        \"modelModifiers\": {},\n    },\n    emits: [\"update:modelValue\"],\n    setup(__props) {\n        const model = _useModel(__props, \"modelValue\");\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"label\", _hoisted_1, [\n                _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((model).value = $event)),\n                    type: \"checkbox\"\n                }, null, 512 /* NEED_PATCH */), [\n                    [_vModelCheckbox, model.value]\n                ]),\n                _renderSlot(_ctx.$slots, \"default\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Checkbox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Checkbox.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","// Module\nvar code = `<h1>处理 D⚙ 条目</h1> <p>按照<a href=\"https://discord.com/channels/1134557553011998840/1413538722078785576\">一些预设作者和角色卡作者的说法</a>, Gemini 和 Claude 不同, 不必将条目插入聊天记录中, 插入其中反而会干扰聊天记录的连续性, 重要条目应该都插入到 D0.</p> <p>但玩家依旧可能使用 Claude、GPT 等游玩, 而对它们还是需要用 D4 等深度的.</p> <p>因此本脚本提供了处理深度条目功能, 允许你特殊处理特定深度 (Dx) 以上和以下的系统深度条目 (D⚙ 条目):</p> <ul> <li>将它们按顺序插入到 D9999/D0: 如果说法无误, 几乎所有预设都能从中获得好处, 而不会产生负面影响</li> <li>或将它们合并成一条文本, 并替换到占位符位置: 预设可以赋予这些条目特殊的语义, 就像有的预设为 AI 把 \"角色定义之前/之后\" 部分定义成 <code>additional_settings</code> 那样</li> </ul> <hr> <p><strong>注意</strong>: 这些选项虽然已经不用角色卡作者自行将条目全设置为 D0，但仍很需要角色卡适配；如果角色详情等会随剧情发展的设定放在了深度条目，则勾选这些选项容易使角色固化。</p> `;\n// Exports\nexport default code;","/* unplugin-vue-components disabled */import script from \"./DepthInjection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DepthInjection.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, toDisplayString as _toDisplayString, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nimport { useSettingsStore } from '../store';\nimport Checkbox from './component/Checkbox.vue';\nimport HelpIcon from './component/HelpIcon.vue';\nimport Section from './component/Section.vue';\nimport Select from './component/Select.vue';\nimport depth_injection_help from './help/depth_injection.md';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DepthInjection',\n    setup(__props) {\n        const store = useSettingsStore();\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(Section, { label: \"处理 D⚙ 条目\" }, {\n                \"label-suffix\": _withCtx(() => [\n                    _createVNode(HelpIcon, { help: _unref(depth_injection_help) }, null, 8 /* PROPS */, [\"help\"])\n                ]),\n                default: _withCtx(() => [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(store).settings.depth_injection.threshold) = $event)),\n                        type: \"number\",\n                        min: \"0\",\n                        class: \"text_pole flex1 wide100p\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [\n                            _vModelText,\n                            _unref(store).settings.depth_injection.threshold,\n                            void 0,\n                            { number: true }\n                        ]\n                    ]),\n                    _createVNode(Checkbox, {\n                        modelValue: _unref(store).settings.depth_injection.above.enabled,\n                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(store).settings.depth_injection.above.enabled) = $event))\n                    }, {\n                        default: _withCtx(() => [\n                            _createElementVNode(\"span\", null, \"处理 D\" + _toDisplayString(_unref(store).settings.depth_injection.threshold) + \" 及以上的 D⚙ 条目\", 1 /* TEXT */)\n                        ]),\n                        _: 1 /* STABLE */\n                    }, 8 /* PROPS */, [\"modelValue\"]),\n                    (_unref(store).settings.depth_injection.above.enabled)\n                        ? (_openBlock(), _createBlock(Select, {\n                            key: 0,\n                            modelValue: _unref(store).settings.depth_injection.above.type,\n                            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(store).settings.depth_injection.above.type) = $event)),\n                            style: { \"width\": \"90%\", \"align-self\": \"flex-end\" },\n                            options: [\n                                { label: '按顺序插入到 D9999', value: 'exclude' },\n                                { label: `合并后替换到 ${_unref(store).settings.depth_injection.above.placeholder} 宏位置`, value: 'placeholder' },\n                            ]\n                        }, null, 8 /* PROPS */, [\"modelValue\", \"options\"]))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createVNode(Checkbox, {\n                        modelValue: _unref(store).settings.depth_injection.below.enabled,\n                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(store).settings.depth_injection.below.enabled) = $event))\n                    }, {\n                        default: _withCtx(() => [\n                            _createElementVNode(\"span\", null, \"处理 D\" + _toDisplayString(_unref(store).settings.depth_injection.threshold) + \" 以下的 D⚙ 条目\", 1 /* TEXT */)\n                        ]),\n                        _: 1 /* STABLE */\n                    }, 8 /* PROPS */, [\"modelValue\"]),\n                    (_unref(store).settings.depth_injection.below.enabled)\n                        ? (_openBlock(), _createBlock(Select, {\n                            key: 1,\n                            modelValue: _unref(store).settings.depth_injection.below.type,\n                            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(store).settings.depth_injection.below.type) = $event)),\n                            style: { \"width\": \"90%\", \"align-self\": \"flex-end\" },\n                            options: [\n                                { label: '按顺序插入到 D0', value: 'exclude' },\n                                { label: `合并后替换到 ${_unref(store).settings.depth_injection.below.placeholder} 宏位置`, value: 'placeholder' },\n                            ]\n                        }, null, 8 /* PROPS */, [\"modelValue\", \"options\"]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","// Module\nvar code = `<h1>停止字符串</h1> <p>如果填入停止字符串, 则 AI 输出了对应文本时将会直接停止输出. 停止字符串可以是字符串或正则, 如 <code>User:</code> 或 <code>/User:|System:/</code>.</p> <p>这可以避免 AI 在输出完剧情后自己和自己对话. 例如, AI 直接回复了以下内容:</p> <pre><code class=\"language-text\">&#x3C;|im_start|> assistant\n剧情……\n&#x3C;|im_end|>\n\n&#x3C;|im_start|> user\nAI 自己作为 user 继续发送消息了!\n&#x3C;|im_end|>\n\n&#x3C;|im_start|> assistant\n剧情……\n&#x3C;|im_end|>\n</code></pre> <p>那么可以把 <code>&#x3C;|im_end|></code> 作为停止字符串.</p> <p>这样一来,</p> <ul> <li>对于流式传输: 当 AI 输出完剧情, 输出到 <code>&#x3C;|im_end|></code> 时, 就会直接停止输出</li> <li>对于非流式传输: 当 AI 回复后, 脚本会删去 <code>&#x3C;|im_end|></code> 及以后的所有文本</li> </ul> `;\n// Exports\nexport default code;","/* unplugin-vue-components disabled */import script from \"./Stop.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Stop.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nimport { useSettingsStore } from '../store';\nimport HelpIcon from './component/HelpIcon.vue';\nimport Section from './component/Section.vue';\nimport stop_help from './help/stop.md';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Stop',\n    setup(__props) {\n        const store = useSettingsStore();\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(Section, { label: \"停止字符串\" }, {\n                \"label-suffix\": _withCtx(() => [\n                    _createVNode(HelpIcon, { help: _unref(stop_help) }, null, 8 /* PROPS */, [\"help\"])\n                ]),\n                default: _withCtx(() => [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(store).settings.stop_string) = $event)),\n                        class: \"text_pole flex1 wide100p\",\n                        type: \"text\",\n                        placeholder: \"请输入字符串或 /正则/\",\n                        autocomplete: \"off\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, _unref(store).settings.stop_string]\n                    ])\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"inline-drawer\"\n};\nconst _hoisted_2 = { class: \"inline-drawer-content\" };\nimport { useSettingsStore } from '../store';\nimport ChatHistory from './ChatHistory.vue';\nimport Delimiter from './Delimiter.vue';\nimport DepthInjection from './DepthInjection.vue';\nimport Stop from './Stop.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Panel',\n    setup(__props) {\n        const store = useSettingsStore();\n        return (_ctx, _cache) => {\n            return (_unref(store).should_enable)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"inline-drawer-toggle inline-drawer-header\" }, [\n                        _createElementVNode(\"b\", null, \"压缩相邻消息\"),\n                        _createElementVNode(\"div\", { class: \"inline-drawer-icon fa-solid fa-circle-chevron-down down\" })\n                    ], -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createVNode(Delimiter),\n                        _createVNode(Stop),\n                        _createVNode(DepthInjection),\n                        _createVNode(ChatHistory)\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Panel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Panel.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createScriptIdDiv, teleportStyle } from '@util/script';\nimport { createPinia } from 'pinia';\nimport { createApp } from 'vue';\nimport Panel from './Panel.vue';\n\nexport function initPanel() {\n  const app = createApp(Panel).use(createPinia());\n\n  const $app = createScriptIdDiv().appendTo('#extensions_settings2');\n  app.mount($app[0]);\n\n  const { destroy } = teleportStyle();\n\n  return {\n    destroy: () => {\n      app.unmount();\n      $app.remove();\n      destroy();\n    },\n  };\n}\n","import { assignInplace, chunkBy, getComplementString, regexFromString } from '@util/common';\nimport { registerAsUniqueScript } from '@util/script';\nimport { compare } from 'compare-versions';\nimport { Settings } from './store';\n\nfunction getPromptContent(prompt: SillyTavern.SendingMessage, settings: Settings): string {\n  if (typeof prompt.content === 'string') {\n    return prompt.content;\n  }\n  return prompt.content\n    .filter(({ type }) => type === 'text')\n    .map(({ text }: any) => text)\n    .join(settings.delimiter.value);\n}\nfunction updatePromptContentWith(\n  prompt: SillyTavern.SendingMessage,\n  updater: (prompt: { role: 'system' | 'assistant' | 'user'; content: string }) => string,\n  settings: Settings,\n): SillyTavern.SendingMessage {\n  const content = updater({ role: prompt.role, content: getPromptContent(prompt, settings) });\n  if (typeof prompt.content === 'string') {\n    prompt.content = content;\n  } else {\n    _.remove(prompt.content, item => item.type === 'text');\n    if (content) {\n      prompt.content.splice(0, 0, { type: 'text', text: content });\n    }\n  }\n  return prompt;\n}\n\nexport type Separators = {\n  head: InjectionPrompt;\n  deep: InjectionPrompt;\n  tail: InjectionPrompt;\n};\n\nexport function injectSeparators(settings: Settings) {\n  const separators: Readonly<Separators> = Object.freeze({\n    head: {\n      id: `\\0${getComplementString('压缩相邻消息-聊天记录开头')}`,\n      position: 'in_chat',\n      depth: 9999,\n      role: 'assistant',\n      content: `【【压缩相邻消息-聊天记录开头】】`,\n    },\n    deep: {\n      id: `\\xff压缩相邻消息-Dx`,\n      position: 'in_chat',\n      depth: settings.depth_injection.threshold,\n      role: 'system',\n      content: `【【压缩相邻消息-Dx】】`,\n    },\n    tail: {\n      id: `\\xff压缩相邻消息-聊天记录结尾`,\n      position: 'in_chat',\n      depth: 0,\n      role: 'system',\n      content: `【【压缩相邻消息-聊天记录结尾】】`,\n    },\n  } as const);\n\n  const inject = (_type: string, _option: object, dry_run: boolean) => {\n    if (dry_run) {\n      return;\n    }\n    injectPrompts(Object.values(separators));\n  };\n  eventOn(tavern_events.GENERATION_AFTER_COMMANDS, inject);\n\n  return {\n    separators,\n    uninject: () => {\n      eventRemoveListener(tavern_events.GENERATION_AFTER_COMMANDS, inject);\n      uninjectPrompts(Object.values(separators).map(({ id }) => id));\n    },\n  };\n}\n\n//----------------------------------------------------------------------------------------------------------------------\nfunction seperatePrompts(\n  prompts: SillyTavern.SendingMessage[],\n  separators: Separators,\n): SillyTavern.SendingMessage[][] | undefined {\n  const head_index = prompts.findIndex(\n    ({ content }) => typeof content === 'string' && content.includes(separators.head.content),\n  );\n  const deep_index = prompts.findIndex(\n    ({ content }) => typeof content === 'string' && content.includes(separators.deep.content),\n  );\n  const tail_index = prompts.findIndex(\n    ({ content }) => typeof content === 'string' && content.includes(separators.tail.content),\n  );\n  if (head_index === -1 || deep_index === -1 || tail_index === -1) {\n    return undefined;\n  }\n\n  const split_with_context = (\n    splitted_before: [string, string],\n    before_index: number,\n    current_index: number,\n    splitter: string,\n  ): [string, string] => {\n    if (before_index !== current_index) {\n      return (prompts[current_index].content as string).split(splitter) as [string, string];\n    }\n    const splitted = splitted_before[1].split(splitter) as [string, string];\n    splitted_before[1] = '';\n    return splitted;\n  };\n\n  const splitted_head = split_with_context(['', ''], -1, head_index, separators.head.content);\n  const splitted_deep = split_with_context(splitted_head, head_index, deep_index, separators.deep.content);\n  const splitted_tail = split_with_context(splitted_deep, deep_index, tail_index, separators.tail.content);\n\n  return [\n    [...prompts.slice(0, head_index), { role: prompts[head_index].role, content: splitted_head[0] }],\n    [\n      { role: prompts[head_index].role, content: splitted_head[1] },\n      ...prompts.slice(head_index + 1, deep_index),\n      { role: prompts[deep_index].role, content: splitted_deep[0] },\n    ],\n    [\n      { role: prompts[deep_index].role, content: splitted_deep[1] },\n      ...prompts.slice(deep_index + 1, tail_index),\n      { role: prompts[tail_index].role, content: splitted_tail[0] },\n    ],\n    [{ role: prompts[tail_index].role, content: splitted_tail[1] }, ...prompts.slice(tail_index + 1)],\n  ];\n}\n\nfunction trimEmptyLines(string: string): string {\n  return _(string)\n    .split('\\n')\n    .dropWhile(line => !line.trim())\n    .dropRightWhile(line => !line.trim())\n    .join('\\n');\n}\n\nfunction rejectEmptyPrompts(prompts: SillyTavern.SendingMessage[]): SillyTavern.SendingMessage[] {\n  return _.reject(prompts, ({ content }) => typeof content === 'string' && content.trim() === '');\n}\n\nfunction squashAdjacentMessage(\n  prompts: SillyTavern.SendingMessage[],\n  settings: Settings,\n): SillyTavern.SendingMessage[] {\n  return chunkBy(\n    prompts,\n    (lhs, rhs) => lhs.role === rhs.role && typeof lhs.content === 'string' && typeof rhs.content === 'string',\n  ).map(chunk => ({\n    role: chunk[0].role,\n    // 长度大于 1, 必然 content 为 string\n    content: chunk.length === 1 ? chunk[0].content : chunk.map(({ content }) => content).join(settings.delimiter.value),\n  }));\n}\n\nfunction squashChatHistory(prompts: SillyTavern.SendingMessage[], settings: Settings): SillyTavern.SendingMessage[] {\n  // TODO: zod encode\n  const prefix = {\n    system: substitudeMacros(settings.chat_history.system_prefix),\n    assistant: substitudeMacros(settings.chat_history.assistant_prefix),\n    user: substitudeMacros(settings.chat_history.user_prefix),\n  };\n  const suffix = {\n    system: substitudeMacros(settings.chat_history.system_suffix),\n    assistant: substitudeMacros(settings.chat_history.assistant_suffix),\n    user: substitudeMacros(settings.chat_history.user_suffix),\n  };\n\n  const tagContent = (prompt: SillyTavern.SendingMessage) =>\n    updatePromptContentWith(\n      prompt,\n      ({ role, content }) => {\n        content = content.includes(prefix[role]) ? content : prefix[role] + content;\n        content = content.includes(suffix[role]) ? content : content + suffix[role];\n        return content;\n      },\n      settings,\n    );\n\n  return chunkBy(prompts, (lhs, rhs) => typeof lhs.content === 'string' && typeof rhs.content === 'string').map(\n    chunk => {\n      chunk.forEach(tagContent);\n\n      return {\n        role: settings.chat_history.squash_role,\n        content:\n          chunk.length === 1 ? chunk[0].content : chunk.map(({ content }) => content).join(settings.delimiter.value),\n      };\n    },\n  );\n}\n\nfunction listenEvent(settings: Settings, separators: Separators, shouldEnable: () => boolean) {\n  const handlePrompts = ({ prompt }: { prompt: SillyTavern.SendingMessage[] }, dry_run: boolean) => {\n    if (dry_run || !shouldEnable()) {\n      return;\n    }\n\n    const chunks = seperatePrompts(prompt, separators)?.map(chunk =>\n      rejectEmptyPrompts(chunk).map(prompt =>\n        updatePromptContentWith(prompt, ({ content }) => trimEmptyLines(content), settings),\n      ),\n    );\n    if (!chunks) {\n      return;\n    }\n\n    const { above, below } = settings.depth_injection;\n\n    const applyInjection = (injection_settings: typeof above, from: number, to: number) => {\n      if (!injection_settings.enabled) {\n        return;\n      }\n\n      const isSystemWithoutPlaceholder = (p: SillyTavern.SendingMessage): boolean =>\n        p.role === 'system' &&\n        !(above.enabled && above.type === 'placeholder' && getPromptContent(p, settings).includes(above.placeholder)) &&\n        !(below.enabled && below.type === 'placeholder' && getPromptContent(p, settings).includes(below.placeholder));\n\n      const placeholder_content =\n        injection_settings.type === 'placeholder'\n          ? chunks[from]\n              .filter(isSystemWithoutPlaceholder)\n              // 没有把图片、多媒体也作为内容, 但无所谓, 世界书里不能设置图片或多媒体\n              .map(p => getPromptContent(p, settings))\n              .join(settings.delimiter.value)\n          : '';\n\n      if (\n        injection_settings.type === 'placeholder' &&\n        _(chunks)\n          .flatten()\n          .some(p => getPromptContent(p, settings).includes(injection_settings.placeholder))\n      ) {\n        _.remove(chunks[from], isSystemWithoutPlaceholder);\n      } else {\n        const exclude_chunk = _.remove(chunks[from], p => p.role === 'system');\n        chunks[to] = to < from ? _.concat(chunks[to], exclude_chunk) : _.concat(exclude_chunk, chunks[to]);\n      }\n      _(chunks)\n        .flatten()\n        .filter(p => getPromptContent(p, settings).includes(injection_settings.placeholder))\n        .forEach(p => {\n          updatePromptContentWith(\n            p,\n            ({ content }) => content.replaceAll(injection_settings.placeholder, placeholder_content),\n            settings,\n          );\n        });\n    };\n    applyInjection(above, 1, 0);\n    applyInjection(below, 2, 3);\n\n    const [head, above_chat_history, below_chat_history, tail] = chunks;\n\n    let result: SillyTavern.SendingMessage[];\n    switch (settings.chat_history.type) {\n      case 'squash_nearby':\n        result = squashAdjacentMessage(_.concat(head, above_chat_history, below_chat_history, tail), settings);\n        break;\n      case 'squash_into_one':\n        result = squashAdjacentMessage(\n          _.concat(head, squashChatHistory(_.concat(above_chat_history, below_chat_history), settings), tail),\n          settings,\n        );\n        break;\n    }\n\n    assignInplace(prompt, result);\n  };\n  const handlePrompts2 = ({ messages }: { messages: SillyTavern.SendingMessage[] }) => {\n    handlePrompts({ prompt: messages }, false);\n  };\n\n  if (compare(getTavernVersion(), '1.13.4', '>')) {\n    eventOn(tavern_events.GENERATE_AFTER_DATA, handlePrompts);\n  } else {\n    eventOn(tavern_events.CHAT_COMPLETION_SETTINGS_READY, handlePrompts2);\n  }\n\n  const handleStopStringOnStream = (text: string) => {\n    if (!settings.stop_string || !shouldEnable()) {\n      return;\n    }\n    const regex = regexFromString(settings.stop_string, true);\n    if (!regex) {\n      return;\n    }\n    if (regex.test(text)) {\n      SillyTavern.stopGeneration();\n    }\n  };\n  eventOn(tavern_events.STREAM_TOKEN_RECEIVED, handleStopStringOnStream);\n\n  const handleStopStringOnReceived = async (message_id: number | string) => {\n    if (!settings.stop_string || !shouldEnable()) {\n      return;\n    }\n\n    const chat_message = SillyTavern.chat[Number(message_id)];\n\n    const regex = regexFromString(settings.stop_string, true);\n    if (!regex) {\n      return;\n    }\n    const match = chat_message.mes.match(regex);\n    if (match) {\n      chat_message.mes = chat_message.mes.slice(0, match.index);\n      if (chat_message.swipes) {\n        _.set(chat_message, ['swipes', chat_message.swipe_id!], chat_message.mes);\n      }\n      // 与 https://gitgud.io/Monblant/noass 采用相同逻辑而不使用 setChatMessages, 因为 CHARACTER_MESSAGE_RENDERED 将会随后自然触发\n      SillyTavern.updateMessageBlock(Number(message_id), chat_message);\n      await SillyTavern.saveChat();\n    }\n  };\n  eventOn(tavern_events.MESSAGE_RECEIVED, handleStopStringOnReceived);\n\n  return {\n    unlisten: () => {\n      eventRemoveListener(tavern_events.GENERATE_AFTER_DATA, handlePrompts);\n      eventRemoveListener(tavern_events.CHAT_COMPLETION_SETTINGS_READY, handlePrompts2);\n      eventRemoveListener(tavern_events.STREAM_TOKEN_RECEIVED, handleStopStringOnStream);\n      eventRemoveListener(tavern_events.MESSAGE_RECEIVED, handleStopStringOnReceived);\n    },\n  };\n}\n\nexport function initSquash(settings: Settings) {\n  const { unregister, getPreferredScriptId } = registerAsUniqueScript('压缩相邻消息');\n  const { separators, uninject } = injectSeparators(settings);\n  const { unlisten } = listenEvent(settings, separators, () => getPreferredScriptId() === getScriptId());\n  return {\n    destroy: () => {\n      unregister();\n      unlisten();\n      uninject();\n    },\n  };\n}\n","import { checkMinimumVersion } from '@util/common';\nimport { loadReadme } from '@util/script';\nimport { initPanel } from './panel';\nimport { initSquash } from './squash';\nimport { useSettingsStore } from './store';\n$(() => {\n    checkMinimumVersion('3.4.17', '压缩相邻消息');\n    loadReadme('https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/压缩相邻消息/README.md');\n    const { destroy: destroyPanel } = initPanel();\n    let destroySquash;\n    watch(() => useSettingsStore().settings, newSettings => {\n        destroySquash?.();\n        destroySquash = initSquash(newSettings).destroy;\n    }, { immediate: true, deep: true });\n    $(window).on('pagehide', () => {\n        destroyPanel();\n        destroySquash();\n    });\n});\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","__esModule","default","locals","add","sfc","props","target","__vccOpts","key","val","listToStyles","parentId","styles","newStyles","part","css","sourceMap","parts","hasDocument","document","DEBUG","Error","stylesInDom","head","getElementsByTagName","singletonElement","singletonCounter","isProduction","noop","options","ssrIdKey","isOldIE","navigator","test","userAgent","toLowerCase","addStylesClient","_isProduction","_options","addStylesToDom","newList","mayRemove","domStyle","refs","j","addStyle","createStyleElement","styleElement","createElement","type","appendChild","obj","update","remove","querySelector","parentNode","removeChild","styleIndex","applyToSingletonTag","bind","applyToTag","newObj","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","ssrId","sources","firstChild","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","chunkBy","array","predicate","chunks","lhs","rhs","_","zip","dropRight","drop","regexFromString","input","replace_macros","makeRegex","pattern","flags","substitudeMacros","RegExp","match","escapeRegExp","pull","indexOf","getComplementString","string","bytes","TextEncoder","encode","complemented","Uint8Array","hex","padStart","registerAsUniqueScript","script_id","getScriptId","path","getPreferredScriptId","registered_scripts","get","window","parent","Set","$","find","toArray","element","String","attr","has","last","value","eventEmit","unregister","delete","listenPreferenceState","callback","eventOn","n","getter","d","a","definition","o","Object","defineProperty","enumerable","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","Vue","z","OldSettings","object","seperator","enum","transform","put_system_injection_after_chat_history","boolean","on_chat_history","squash_role","user_prefix","user_suffix","assistant_prefix","assistant_suffix","system_prefix","system_suffix","stop_string","Settings","parse","delimiter","depth_injection","threshold","above","enabled","placeholder","below","chat_history","prefault","catch","number","int","min","useSettingsStore","variables","getVariables","settings","ref","should_enable","preferred_script_id","watchEffect","replaceVariables","useEscapedNewline","computed","replace","set","_hoisted_1","class","_hoisted_2","__name","label","setup","__props","_ctx","_cache","$slots","help","role","tabindex","onClick","$event","SillyTavern","callGenericPopup","POPUP_TYPE","TEXT","allowVerticalScrolling","leftAlign","wide","_hoisted_3","required","emits","model","option","store","user_prefix_input","user_suffix_input","assistant_prefix_input","assistant_suffix_input","system_prefix_input","system_suffix_input","Section","HelpIcon","Select","modelValue","Field","Item","autocomplete","Checkbox","style","Delimiter","Stop","DepthInjection","ChatHistory","initPanel","app","createApp","Panel","use","$app","appendTo","mount","destroy","append_to","$div","append","clone","teleportStyle","unmount","getPromptContent","prompt","text","updatePromptContentWith","updater","splice","squashAdjacentMessage","prompts","chunk","listenEvent","separators","shouldEnable","handlePrompts","dry_run","head_index","findIndex","includes","deep_index","deep","tail_index","tail","split_with_context","splitted_before","before_index","current_index","splitter","split","splitted","splitted_head","splitted_deep","splitted_tail","slice","seperatePrompts","rejectEmptyPrompts","reject","trim","dropWhile","line","dropRightWhile","applyInjection","injection_settings","from","to","isSystemWithoutPlaceholder","p","placeholder_content","flatten","some","exclude_chunk","forEach","replaceAll","above_chat_history","below_chat_history","result","prefix","system","assistant","user","suffix","tagContent","squashChatHistory","destination","new_array","handlePrompts2","messages","getTavernVersion","tavern_events","GENERATE_AFTER_DATA","CHAT_COMPLETION_SETTINGS_READY","handleStopStringOnStream","regex","stopGeneration","STREAM_TOKEN_RECEIVED","handleStopStringOnReceived","async","message_id","chat_message","chat","Number","mes","swipes","swipe_id","updateMessageBlock","saveChat","MESSAGE_RECEIVED","unlisten","eventRemoveListener","initSquash","uninject","freeze","position","depth","inject","_type","_option","injectPrompts","values","GENERATION_AFTER_COMMANDS","uninjectPrompts","injectSeparators","expected","title","getTavernHelperVersion","toastr","error","checkMinimumVersion","url","readme","fetch","ok","readme_text","replaceScriptInfo","loadReadme","destroyPanel","destroySquash","watch","newSettings","immediate","on"],"sourceRoot":""}