import{compare as e}from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';function t(e){return e.closest('.completion_prompt_manager_prompt').attr('data-pm-identifier')}function n(){r.disconnect();const e=$('.completion_prompt_manager_prompt:has(.fa-asterisk), .completion_prompt_manager_prompt:has(.fa-syringe), .completion_prompt_manager_prompt:has(.fa-square-poll-horizontal)'),n=e.find('.prompt_manager_prompt_controls');e.find('.prompt_manager_prompt_tokens').css('pointer-events','none'),n.find('span[title="Remove"], span[title="copy"], span[title="delete"]').remove(),n.prepend($('<span title="delete" class="prompt-manager-remove-action caution fa-solid fa-trash fa-xs"></span>').on('click',async function(){if(!await SillyTavern.callGenericPopup('确定要永久删除这个条目吗?',SillyTavern.POPUP_TYPE.CONFIRM))return;const e=t($(this));await updatePresetWith('in_use',t=>{const n=t.prompts.findIndex(t=>t.id===e);return-1===n||t.prompts.splice(n,1),t},{render:'immediate'})}),$('<span title="copy" class="prompt-manager-copy-action fa-solid fa-copy fa-xs"></span>').on('click',async function(){const e=t($(this));await updatePresetWith('in_use',t=>{const n=t.prompts.findIndex(t=>t.id===e);return-1===n||t.prompts.splice(n+1,0,t.prompts[n]),t},{render:'immediate'})})),r.observe($('#completion_prompt_manager')[0],{childList:!0,subtree:!0})}const o=_.debounce(n,500),r=new MutationObserver(o);$(()=>{!async function(t,n){e(await getTavernHelperVersion(),t,'<')&&toastr.error(`'${n}' 需要酒馆助手版本 >= '${t}'`,'版本不兼容')}('3.4.4','预设条目更多按钮'),async function(e){const t=await fetch(e);if(!t.ok)return!1;const n=await t.text();replaceScriptInfo(n)}('https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/预设条目更多按钮/README.md'),n()}),$(window).on('pagehide',()=>{replacePreset('in_use',getPreset('in_use')),r.disconnect()});
//# sourceMappingURL=index.js.map