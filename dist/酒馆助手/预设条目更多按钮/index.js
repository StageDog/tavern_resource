import{compare as t}from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import'https://testingcf.jsdelivr.net/npm/json5/+esm';import'https://testingcf.jsdelivr.net/npm/jsonrepair/+esm';import'https://testingcf.jsdelivr.net/npm/zod/v4/core/+esm';function e(t){return t.closest('.completion_prompt_manager_prompt').attr('data-pm-identifier')}function n(){o.disconnect();const t=$('.completion_prompt_manager_prompt:has(.fa-asterisk), .completion_prompt_manager_prompt:has(.fa-syringe), .completion_prompt_manager_prompt:has(.fa-square-poll-horizontal)'),n=t.find('.prompt_manager_prompt_controls');t.find('.prompt_manager_prompt_tokens').css('pointer-events','none'),n.find('span[title="Remove"], span[title="copy"], span[title="delete"]').remove(),n.prepend($('<span title="delete" class="prompt-manager-remove-action caution fa-solid fa-trash fa-xs"></span>').on('click',async function(){if(!await SillyTavern.callGenericPopup('确定要永久删除这个条目吗?',SillyTavern.POPUP_TYPE.CONFIRM))return;const t=e($(this));await updatePresetWith('in_use',e=>{const n=e.prompts.findIndex(e=>e.id===t);return-1===n||e.prompts.splice(n,1),e},{render:'immediate'})}),$('<span title="copy" class="prompt-manager-copy-action fa-solid fa-copy fa-xs"></span>').on('click',async function(){const t=e($(this));await updatePresetWith('in_use',e=>{const n=e.prompts.findIndex(e=>e.id===t);return-1===n||e.prompts.splice(n+1,0,e.prompts[n]),e},{render:'immediate'})})),o.observe($('#completion_prompt_manager')[0],{childList:!0,subtree:!0})}const r=_.debounce(n,500),o=new MutationObserver(r);$(()=>{!async function(e,n){t(await getTavernHelperVersion(),e,'<')&&toastr.error(`'${n}' 需要酒馆助手版本 >= '${e}'`,'版本不兼容')}('3.4.4','预设条目更多按钮'),async function(t){const e=await fetch(t);if(!e.ok)return!1;const n=await e.text();replaceScriptInfo(n)}('https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/预设条目更多按钮/README.md'),n()}),$(window).on('pagehide',()=>{replacePreset('in_use',getPreset('in_use')),o.disconnect()});
//# sourceMappingURL=index.js.map