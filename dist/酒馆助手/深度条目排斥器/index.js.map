{"version":3,"file":"index.js","mappings":"mQAIAA,EAAE,MC4BKC,eAAmCC,EAAkBC,GACtD,QAAcC,yBAA0BF,EAAU,MACpDG,OAAOC,MAAM,IAAIH,mBAAuBD,KAAa,QAEzD,CD/BEK,CAAoB,SAAU,WCiCzBN,eAA0BO,GAC/B,MAAMC,QAAeC,MAAMF,GAC3B,IAAKC,EAAOE,GACV,OAAO,EAET,MAAMC,QAAoBH,EAAOI,OACjCC,kBAAkBF,EAEpB,CDxCEG,CAAW,yFACX,MAAM,QAAEC,GAAY,EAClB,EAASC,MAAM,CACbC,KAAM,QACNC,yCAAyC,EACzCC,gBAAiB,CACfC,KAAM,YAIZrB,EAAEsB,QAAQC,GAAG,WAAY,KACvBP","sources":["src://tavern_helper_template/src/酒馆助手/深度条目排斥器/index.ts","src://tavern_helper_template/src/util/tavern.ts"],"sourcesContent":["import { checkMinimumVersion, loadReadme } from 'util/tavern';\nimport { Settings } from '酒馆助手/压缩相邻消息/settings';\nimport { initSquash } from '酒馆助手/压缩相邻消息/squash';\n\n$(() => {\n  checkMinimumVersion('3.4.17', '深度条目排斥器');\n  loadReadme('https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/深度条目排斥器/README.md');\n  const { destroy } = initSquash(\n    Settings.parse({\n      name: '深度排斥器',\n      put_system_injection_after_chat_history: true,\n      on_chat_history: {\n        type: 'mixin',\n      },\n    }),\n  );\n  $(window).on('pagehide', () => {\n    destroy();\n  });\n});\n","import { compare } from 'compare-versions';\n\nexport function assignInplace<T>(destination: T[], new_array: T[]): T[] {\n  destination.length = 0;\n  destination.push(...new_array);\n  return destination;\n}\n\nexport function chunkBy<T>(array: T[], predicate: (lhs: T, rhs: T) => boolean): T[][] {\n  if (array.length === 0) {\n    return [];\n  }\n\n  const chunks: T[][] = [[array[0]]];\n  for (const [lhs, rhs] of _.zip(_.dropRight(array), _.drop(array))) {\n    if (predicate(lhs!, rhs!)) {\n      chunks[chunks.length - 1].push(rhs!);\n    } else {\n      chunks.push([rhs!]);\n    }\n  }\n  return chunks;\n}\n\nexport function uuidv4(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport async function checkMinimumVersion(expected: string, title: string) {\n  if (compare(await getTavernHelperVersion(), expected, '<')) {\n    toastr.error(`'${title}' 需要酒馆助手版本 >= '${expected}'`, '版本不兼容');\n  }\n}\n\nexport async function loadReadme(url: string): Promise<boolean> {\n  const readme = await fetch(url);\n  if (!readme.ok) {\n    return false;\n  }\n  const readme_text = await readme.text();\n  replaceScriptInfo(readme_text);\n  return true;\n}\n\nexport function teleportStyle() {\n  if ($(`head > div[script_id=\"${getScriptId()}\"]`).length > 0) {\n    return;\n  }\n  const $div = $(`<div>`).attr('script_id', getScriptId()).append($(`head > style`, document).clone());\n  $('head').append($div);\n}\n\nexport function deteleportStyle() {\n  $(`head > div[script_id=\"${getScriptId()}\"]`).remove();\n}\n\nexport function createScriptIdDiv(): JQuery<HTMLDivElement> {\n  return $('<div>').attr('script_id', getScriptId()) as JQuery<HTMLDivElement>;\n}\n\nexport function destroyScriptIdDiv(): void {\n  $(`div[script_id=\"${getScriptId()}\"]`).remove();\n}\n"],"names":["$","async","expected","title","getTavernHelperVersion","toastr","error","checkMinimumVersion","url","readme","fetch","ok","readme_text","text","replaceScriptInfo","loadReadme","destroy","parse","name","put_system_injection_after_chat_history","on_chat_history","type","window","on"],"sourceRoot":""}