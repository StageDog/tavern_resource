import{compare as e}from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';function t(e){$('#wiActivationSettings').find('input, select').prop('disabled',e)}$(async()=>{var n;e(await getTavernHelperVersion(),'4.7.0','>=')||(!async function(e){const t=await fetch(e);if(!t.ok)return!1;const n=await t.text();replaceScriptInfo(n)}('https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/世界书强制用推荐的全局设置/README.md'),n=!1,appendInexistentScriptButtons(getScriptId(),[{name:'处理要禁用递归扫描的世界书',visible:n}]),eventOnButton('处理要禁用递归扫描的世界书',async()=>{const e=getLorebooks();let t=null;const n=$('<div>').append('<div><h4><span>请选择你要处理的世界书</span></h4></div>',$('<div>').append($('<select><option value="">--- None ---</option></select>').append(e.map((e,t)=>new Option(e,String(t)))).on('change',async function(){const n=String($(this).val());if(''===n)return void(t=null);const i=e.at(Number(n));t=i??null})));await SillyTavern.callGenericPopup(n[0],SillyTavern.POPUP_TYPE.CONFIRM)===SillyTavern.POPUP_RESULT.AFFIRMATIVE&&t&&(await updateLorebookEntriesWith(t,e=>(e.forEach(e=>{e.exclude_recursion=!0,e.prevent_recursion=!0}),e)),SillyTavern.callGenericPopup(`已禁用 '${t}' 的递归扫描`,SillyTavern.POPUP_TYPE.TEXT))}),setLorebookSettings({scan_depth:2,context_percentage:100,budget_cap:0,min_activations:0,max_depth:0,max_recursion_steps:0,insertion_strategy:'character_first',include_names:!1,recursive:!0,case_sensitive:!1,match_whole_words:!1,use_group_scoring:!1,overflow_alert:!1}),t(!0),$(window).on('pagehide',()=>t(!1)))});
//# sourceMappingURL=index.js.map