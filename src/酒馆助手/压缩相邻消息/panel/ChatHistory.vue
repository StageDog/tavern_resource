<template>
  <Section label="åˆå¹¶èŠå¤©åŽ†å²">
    <Select
      v-model="store.settings.chat_history.type"
      :options="[
        { label: 'ä¸Žå…¶ä»–æç¤ºè¯æ··åˆ', value: 'mixin' },
        { label: 'ä¸Žå…¶ä»–æç¤ºè¯éš”ç¦»', value: 'seperate' },
        { label: 'å•ç‹¬åŽ‹ç¼©ä¸ºä¸€æ¡æ¶ˆæ¯', value: 'squash' },
      ]"
    />

    <template v-if="store.settings.chat_history.type === 'squash'">
      <Field label="åŽ‹ç¼©è§’è‰²">
        <Select
          v-model="store.settings.chat_history.squash_role"
          :options="[
            { label: 'âš™ç³»ç»Ÿ', value: 'system' },
            { label: 'ðŸ‘¤ç”¨æˆ·', value: 'user' },
            { label: 'ðŸ¤–åŠ©æ‰‹', value: 'assistant' },
          ]"
        />
      </Field>

      <Field label="æç¤ºè¯å‰åŽç¼€">
        <Item label="ç”¨æˆ·å‰ç¼€">
          <input v-model="user_prefix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
        <Item label="ç”¨æˆ·åŽç¼€">
          <input v-model="user_suffix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
        <Item label="åŠ©æ‰‹å‰ç¼€">
          <input v-model="assistant_prefix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
        <Item label="åŠ©æ‰‹åŽç¼€">
          <input v-model="assistant_suffix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
        <Item label="ç³»ç»Ÿå‰ç¼€">
          <input v-model="system_prefix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
        <Item label="ç³»ç»ŸåŽç¼€">
          <input v-model="system_suffix_input" class="text_pole flex1 wide100p" type="text" autocomplete="off" />
        </Item>
      </Field>
    </template>
  </Section>
</template>

<script setup lang="ts">
import { useSettingsStore } from '../store';
import Field from './component/Field.vue';
import Item from './component/Item.vue';
import Section from './component/Section.vue';
import Select from './component/Select.vue';

const store = useSettingsStore();

const user_prefix_input = store.useEscapedNewline('chat_history.user_prefix');
const user_suffix_input = store.useEscapedNewline('chat_history.user_suffix');
const assistant_prefix_input = store.useEscapedNewline('chat_history.assistant_prefix');
const assistant_suffix_input = store.useEscapedNewline('chat_history.assistant_suffix');
const system_prefix_input = store.useEscapedNewline('chat_history.system_prefix');
const system_suffix_input = store.useEscapedNewline('chat_history.system_suffix');
</script>
